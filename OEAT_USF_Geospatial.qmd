---
title: "OEAT/USF Water Quality Interpolation Project"
author: "Stephen Durham"
date: "12/14/2022"
format:
  html:
    code-fold: true
    code-summary: "View code"
    code-tools: true
    embed-resources: true
    theme: cosmo
    number-sections: true
execute: 
  enabled: true
  cache: true
editor: visual
editor_options: 
  chunk_output_type: inline
---

```{r setup}
#| echo: FALSE
#| warning: FALSE
#| error: FALSE

library(tidyverse)
library(data.table)
library(scales)
library(sf)
library(gtable)
library(grid)
library(gridExtra)
library(colorspace)
library(here)
library(pdftools)
library(rpolars)
library(lubridate)
library(patchwork)

ddat <- fread(here::here("OEAT_Discrete-2022-Sep-14.csv"))


```

```{r crop-hook}
#| cache: FALSE
#| echo: FALSE
#| eval: FALSE
#| include: FALSE

knitr::knit_hooks$set(crop=hook_pdfcrop)

```

```{r SpatialCoverage}
#| crop: TRUE
#| eval: FALSE
#| include: FALSE

rcp <- st_read(here::here("mapping/orcp_all_sites/orcp_all_sites/ORCP_Managed_Areas.shp"))
counties <- st_read(here::here("mapping/FLCounties/Counties_-_Detailed_Shoreline.shp"))
corners <- fread(here::here("mapping/MApolygons_corners.csv"))

rcp <- st_make_valid(rcp)
counties <- st_make_valid(counties)
rcp <- st_transform(rcp, crs = 4326)
counties <- st_transform(counties, crs = 4326)

ddat_g <- st_as_sf(distinct(ddat[!is.na(Latitude_DD) & !is.na(Longitude_DD) & ParameterName %in% c("Dissolved Oxygen", "pH", "Salinity", "Secchi Depth", "Water Temperature", "Turbidity", "Total Phosphorus", "Total Suspended Solids, TSS", "Total Nitrogen"), .(ManagedAreaName, Month, Year, Longitude_DD, Latitude_DD, ParameterName)]), coords = c("Longitude_DD", "Latitude_DD"), crs = 4326)
ddat_g$Month <- factor(ddat_g$Month, levels = c(1:12))
ddat_g$ParameterName <- ifelse(str_detect(ddat_g$ParameterName, "TSS"), "Total Suspended Solids", ddat_g$ParameterName)

i <- "Biscayne Bay Aquatic Preserve"
p <- "Secchi Depth"
mcols <- sequential_hcl(12, palette = "Inferno")
mcols <- c(mcols, "transparent")
names(mcols) <- c(as.character(seq(1:12)), "no data")

for(p in unique(ddat_g$ParameterName)){
  for(i in unique(ddat_g$ManagedAreaName)){
    plotdat <- subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)
    missingyrs <- sort(setdiff(c(min(plotdat$Year):max(plotdat$Year)), unique(plotdat$Year)))
    if(length(missingyrs) > 0){
      mys <- st_as_sf(data.table(ManagedAreaName = i,
                                 Month = "no data",
                                 Year = missingyrs,
                                 ParameterName = p,
                                 geometry = plotdat$geometry[1]))
      
      plotdat <- rbind(plotdat, mys)
    }
    
    plotdat$lab_nd <- ifelse(plotdat$Month == "no data", "No Data", "")
    
    xmin <- st_bbox(subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)$geometry)[names(st_bbox(subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)$geometry)) %in% c("xmin", "xmax")][[1]]
    xmax <- st_bbox(subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)$geometry)[names(st_bbox(subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)$geometry)) %in% c("xmin", "xmax")][[2]]
    xbrk <- c(plyr::round_any(xmin, 0.01, f = ceiling), plyr::round_any(xmin + (xmax - xmin)/2, 0.01, f = round), plyr::round_any(xmax, 0.01, f = floor))
        
    ymin <- st_bbox(subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)$geometry)[names(st_bbox(subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)$geometry)) %in% c("ymin", "ymax")][[1]]
    ymax <- st_bbox(subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)$geometry)[names(st_bbox(subset(ddat_g, ddat_g$ManagedAreaName == i & ddat_g$ParameterName == p)$geometry)) %in% c("ymin", "ymax")][[2]]
    ybrk <- c(plyr::round_any(ymin, 0.01, f = ceiling), plyr::round_any(ymin + (ymax - ymin)/2, 0.01, f = round), plyr::round_any(ymax, 0.01, f = floor))
    
    lab_x <- xmax - ((xmax - xmin)/2) - ((xmax - xmin) * 0.05)
    lab_y <- ymax - (ymax - ymin) * 0.005
    
    i_p <- ggplot(data = plotdat) +
      geom_sf(data = subset(rcp, rcp$LONG_NAME == i)) +
      geom_sf(aes(color = Month, size = Month)) +
      geom_text(data = plotdat, aes(label = lab_nd), 
               x = lab_x, y = ymax, size = 8/.pt, hjust = "center", vjust = "bottom", fontface = "bold") +
      # scale_size_manual(values = c(3.75, 3.5, 3.25, 3, 2.75, 2.5, 2.25, 2, 1.75, 1.5, 1.25, 1), labels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12")) +
      scale_size_manual(values = c(3.75, 3.5, 3.25, 3, 2.75, 2.5, 2.25, 2, 1.75, 1.5, 1.25, 1, 0.01), labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", "")) +
      scale_x_continuous(breaks = xbrk) +
      scale_y_continuous(breaks = ybrk) +
      scale_color_manual(values = mcols, labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", "")) +
      theme_classic(base_size = 9) +
      labs(title = i, subtitle = paste0("Discrete, ", p)) +
      facet_wrap(~Year, ncol = 10) +
      theme(plot.margin = margin(10, 10, 10, 10),
            plot.background = element_rect(color = "grey99"),
            axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
    
    saveRDS(i_p, here::here(paste0("plots/Discrete_", str_replace_all(i, " ", ""), "_", str_replace_all(p, " ", ""), ".rds")))
    
    ggsave(here::here(paste0("plots/Discrete_", str_replace_all(i, " ", ""), "_", str_replace_all(p, " ", ""), ".pdf")),
           i_p,
           height = ceiling(length(unique(plotdat$Year))/10) * 3,
           width = ifelse(length(unique(plotdat$Year)) < 10, (length(unique(plotdat$Year)) * 3) + 6, 36),
           dpi = 300)
    
    # ggsave(here::here(paste0("plots/Discrete_", str_replace_all(i, " ", ""), "_", str_replace_all(p, " ", ""), ".png")),
    #        i_p,
    #        height = ceiling(length(unique(plotdat$Year))/10) * 3,
    #        width = ifelse(length(unique(plotdat$Year)) < 10, (length(unique(plotdat$Year)) * 3) + 6, 36),
    #        dpi = 300)
    
    #Crop extra white space
    knitr::plot_crop(here::here(paste0("plots/Discrete_", str_replace_all(i, " ", ""), "_", str_replace_all(p, " ", ""), ".pdf")))
    
    #render bitmap
    bitmap <- pdftools::pdf_render_page(here::here(paste0("plots/Discrete_", str_replace_all(i, " ", ""), "_", str_replace_all(p, " ", ""), ".pdf")), dpi = 600)
    
    #create .png version
    png::writePNG(bitmap, here::here(paste0("plots/Discrete_", str_replace_all(i, " ", ""), "_", str_replace_all(p, " ", ""), ".png")))
    
    
    print(paste0("Done with ", p, " plot for ", i, "!"))
  }
}


# Code from SAV script for vertically arranged multi-year maps

# #add 20% of difference (xmax-xmin) to xmax to help prevent year labels from getting cut off map images and 10% to ymax
# corners[, `:=` (xmax = xmax + (xmax-xmin)*0.25, ymax = ymax + (ymax-ymin)*0.1)]
# 
# locs_pts <- st_make_valid(locs_pts)
# locs_lns <- st_make_valid(locs_lns)
# rcp <- st_make_valid(rcp)
# counties <- st_make_valid(counties)
# 
# locs_pts <- st_transform(locs_pts, crs = 4326)
# locs_lns <- st_transform(locs_lns, crs = 4326)
# rcp <- st_transform(rcp, crs = 4326)
# counties <- st_transform(counties, crs = 4326)
# 
# locs_pts_rcp <- locs_pts[rcp, , op = st_intersects]
# locs_lns_rcp <- locs_lns[rcp, , op = st_intersects]

# fl_i <- st_crop(counties, xmin = corners[ManagedAreaName == i, xmin], xmax = corners[ManagedAreaName == i, xmax], ymin = corners[ManagedAreaName == i, ymin], ymax = corners[ManagedAreaName == i, ymax])
#       rcp_i <- subset(rcp, rcp$LONG_NAME == ifelse(stringr::str_detect(i, "NERR"), paste0(str_sub(i, 1, -6), " National Estuarine Research Reserve"), 
#                                                    ifelse(stringr::str_detect(i, "NMS"), paste0(str_sub(i, 1, -5), " National Marine Sanctuary"), 
#                                                           ifelse(str_detect(i, "Fort Clinch|Fort Pickens|Rocky Bayou|St. Andrews"), paste0(i, " State Park Aquatic Preserve"), paste0(i, " Aquatic Preserve")))))
#       
#       locs_pts_rcp_i <- locs_pts_rcp[rcp_i, , op = st_intersects]
#       locs_lns_rcp_i <- locs_lns_rcp[rcp_i, , op = st_intersects]
#       
#       yadd <- 0
#       startyear <- min(SAV4[ManagedAreaName == i & !is.na(eval(p)), Year])
#       base <- ggplot() +
#         geom_sf(data = rotate_sf(fl_i, coast = corners[ManagedAreaName == i, Coast[1]]), fill = "beige", color = "navajowhite3", inherit.aes = FALSE) +
#         geom_sf(data = rotate_sf(rcp_i, coast = corners[ManagedAreaName == i, Coast[1]]), color = "grey50", fill = "mediumaquamarine", alpha = 0.4, lwd = 1, inherit.aes = FALSE) +
#         #scale_fill_brewer(palette = "Dark2") +
#         scale_color_manual(values = subset(prcols, names(prcols) %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)), ProgramID])), 
#                            aesthetics = c("color", "fill")) +
#         labs(title = ifelse(stringr::str_detect(i, "NERR"), paste0(str_sub(i, 1, -6), " National Estuarine Research Reserve"), 
#                             ifelse(stringr::str_detect(i, "NMS"), paste0(str_sub(i, 1, -5), " National Marine Sanctuary"), paste0(i, " Aquatic Preserve"))), 
#              fill = "Program ID") +
#         theme(panel.grid.major = element_line(colour = NA),
#               panel.grid.minor = element_line(colour = NA),
#               axis.text = element_blank(),
#               axis.ticks = element_blank(),
#               axis.title = element_blank(),
#               panel.background = element_rect(fill = NA),
#               plot.background = element_rect(colour = NA))
#       ystart <- ifelse(corners[ManagedAreaName == i, Coast[1]] == "Atlantic", attributes(base$layers[[2]]$data$geometry)$bbox$ymax[[1]], attributes(base$layers[[2]]$data$geometry)$bbox$ymin[[1]])
#       xlab <- attributes(base$layers[[2]]$data$geometry)$bbox$xmax[[1]] + (attributes(base$layers[[2]]$data$geometry)$bbox$xmax[[1]] - attributes(base$layers[[2]]$data$geometry)$bbox$xmin[[1]])/50
#       MAcoords <- setDT(as.data.frame(st_coordinates(rcp_i)))
#       maxdist <- max(st_distance(st_as_sf(MAcoords[X == min(X), ], coords = c("X", "Y"), crs = 4326), st_as_sf(MAcoords[Y == max(Y), ], coords = c("X", "Y"), crs = 4326)),
#                      st_distance(st_as_sf(MAcoords[X == max(X), ], coords = c("X", "Y"), crs = 4326), st_as_sf(MAcoords[Y == min(Y), ], coords = c("X", "Y"), crs = 4326)),
#                      st_distance(st_as_sf(MAcoords[X == min(X), ], coords = c("X", "Y"), crs = 4326), st_as_sf(MAcoords[X == max(X), ], coords = c("X", "Y"), crs = 4326)),
#                      st_distance(st_as_sf(MAcoords[Y == min(Y), ], coords = c("X", "Y"), crs = 4326), st_as_sf(MAcoords[Y == max(Y), ], coords = c("X", "Y"), crs = 4326)))
#       area <- st_area(rcp_i)
#       xyratio <- as.numeric((area/maxdist)/maxdist)
#       
#       MApolycoords <- setDT(as.data.frame(st_coordinates(base$layers[[2]]$data)))
#       xmax_y <- MApolycoords[X == max(X), Y]
#       base <- base + annotate("text", x = xlab, y = xmax_y, label = paste0(startyear), hjust = "left")
#       
#       MApolycoords[, Xrnd := round(X, 3)][, ydists := max(Y) - min(Y), by = Xrnd]
#       maxydist <- max(MApolycoords$ydists) + ((max(MApolycoords$ydists)/25) / xyratio) 
#       
#       if(length(subset(locs_pts_rcp_i, locs_pts_rcp_i$LocationID %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year == startyear, LocationID]))$LocationID) > 0){
#         base <- base +
#           geom_sf(data = rotate_sf(subset(locs_pts_rcp_i, locs_pts_rcp_i$LocationID %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year == startyear, LocationID])),
#                                    coast = corners[ManagedAreaName == i, Coast[1]]),
#                   aes(fill = droplevels(as.factor(ProgramID))), shape = 21, color = "black")
#       }
#       
#       if(length(subset(locs_lns_rcp_i, locs_lns_rcp_i$LocationID %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year == startyear, LocationID]))$LocationID) > 0){
#         base <- base +
#           geom_sf(data = rotate_sf(subset(locs_lns_rcp_i, locs_lns_rcp_i$LocationID %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year == startyear, LocationID])),
#                                    coast = corners[ManagedAreaName == i, Coast[1]]),
#                   aes(color = droplevels(as.factor(ProgramID))), shape = 21)
#       }
#       
#       for(y in sort(unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year != startyear, Year]))){
#         base <- base +
#           geom_sf(data = rotate_sf(rcp_i, y_add = yadd + maxydist, coast = corners[ManagedAreaName == i, Coast[1]]), 
#                   color = "grey50", fill = "mediumaquamarine", alpha = 0.85, lwd = 1, inherit.aes = FALSE) +
#           annotate("text", x = xlab, y = xmax_y + yadd + maxydist, label = y, hjust = "left")
#         
#         if(length(subset(locs_pts_rcp_i, locs_pts_rcp_i$LocationID %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year == y, LocationID]))$LocationID) > 0){
#           base <- base +
#             geom_sf(data = rotate_sf(subset(locs_pts_rcp_i, locs_pts_rcp_i$LocationID %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year == y, LocationID])),
#                                      y_add = yadd + maxydist, coast = corners[ManagedAreaName == i, Coast[1]]), 
#                     aes(fill = droplevels(as.factor(ProgramID))), shape = 21, color = "black")
#         }
#         
#         if(length(subset(locs_lns_rcp_i, locs_lns_rcp_i$LocationID %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year == startyear, LocationID]))$LocationID) > 0){
#           base <- base +
#             geom_sf(data = rotate_sf(subset(locs_lns_rcp_i, locs_lns_rcp_i$LocationID %in% unique(SAV4[ManagedAreaName == i & !is.na(eval(p)) & Year == startyear, LocationID])),
#                                      y_add = yadd + maxydist, coast = corners[ManagedAreaName == i, Coast[1]]),
#                     aes(color = droplevels(as.factor(ProgramID))), shape = 21)
#         }
#         
#         yadd <- yadd + maxydist
#         startyear <- startyear + 1
#         ystart <- ystart + maxydist
#       }        
#       
#       saveRDS(base, here::here(paste0("SAV/output/Figures/BB/SAV_", parameters[column == p, type], "_", 
#                                       gsub('\\b(\\pL)\\pL{2,}|.','\\U\\1', i, perl = TRUE),
#                                       ifelse(stringr::str_detect(i, "NERR"), "ERR_map_bypr.rds", 
#                                              ifelse(stringr::str_detect(i, "NMS"), "MS_map_bypr.rds", "AP_map_bypr.rds")))))
#       
#       #Save image file versions of the maps
#       # nlayers <- 0
#       # for(k in seq_along(base$layers)){
#       #   class_k <- class(base$layers[[k]])[2]
#       #   if(class_k == 'Layer'){
#       #     nlayers <- nlayers + 1
#       #   } else{
#       #     next
#       #   }
#       # }
#       
#       base <- base +
#         theme(legend.position='right', 
#               legend.justification='top',
#               legend.direction='vertical')
#       
#       ggsave(filename = here::here(paste0("SAV/output/Figures/BB/img/SAV_", parameters[column == p, type], "_", 
#                                           gsub('\\b(\\pL)\\pL{2,}|.','\\U\\1', i, perl = TRUE),
#                                           ifelse(stringr::str_detect(i, "NERR"), "ERR_map_bypr.jpg", 
#                                                  ifelse(stringr::str_detect(i, "NMS"), "MS_map_bypr.jpg", "AP_map_bypr.jpg")))), 
#              plot = base,
#              width = 6,
#              #height = 8 + nlayers - 5,
#              height = yadd/maxydist,
#              limitsize = FALSE)


```

# Assigning seasons to continuous water quality monitoring time series

Here I describe a potential method to assign seasons to the SEACAR continuous water quality monitoring data using running quantiles. I chose 5%, 50% and 95% running quantiles with roughly daily intervals (i.e., window width of 96 observations, assuming 15-minute data), but these options could of course be changed as needed. I also chose to test the method on salinity and temperature data from 2005 collected at station EB01 in Estero Bay Aquatic Preserve (southwest Florida). The idea would be to use the points at which the running quantiles cross some threshold values to delineate seasons in a reproducible way that is based on the data themselves. In this example I have used the 5%, 50%, and 95% quantiles of the whole year-long time series as the thresholds for determining the transition points between seasons.

The time series data for both temperature and salinity showed seasonality in the running quartile data, but also substantial intra-season variation, and generalized additive model (GAM) fits to the running quartile data didn't cross their corresponding timeseries quantile values very much, if at all ({#fig-SeasonDef}A). However, daily coefficients of variation (CV) also showed some seasonal periodicity for both parameters, with the 5% and 95% quantile daily CV's being roughly anti-correlated ({#fig-SeasonDef}B).

::: {.panel-tabset}

## Temperature

```{r SeasonDef}
#| warning: FALSE
#| error: FALSE
#| label: fig-SeasonDef
#| fig-cap: "Plots showing (A) the rolling quantile outputs and GAM fits for 5%, 50%, and 95% quantiles of temperature using a 96-observation window and (B) the coefficient of variation (sd/mean) of observations for each sample date."

mas <- c("Big Bend Seagrasses Aquatic Preserve", "Biscayne Bay Aquatic Preserve", "Estero Bay Aquatic Preserve", "Guana River Marsh Aquatic Preserve", "Gasparilla Sound-Charlotte Harbor Aquatic Preserve")

temps <- fread(here::here("Combined_WQ_WC_NUT_cont_Water_Temperature_SW-2022-Nov-16.txt"), sep = "|")
sals <- fread(here::here("Combined_WQ_WC_NUT_cont_Salinity_SW-2022-Nov-16.txt"), sep = "|")

temps <- temps[ManagedAreaName %in% mas, ]
sals <- sals[ManagedAreaName %in% mas, ]

temps_reg <- fread(here::here("Combined_WQ_WC_NUT_cont_Water_Temperature_SE-2022-Nov-16.txt"), sep = "|")
sals_reg <- fread(here::here("Combined_WQ_WC_NUT_cont_Salinity_SE-2022-Nov-16.txt"), sep = "|")

temps_reg <- temps_reg[ManagedAreaName %in% mas, ]
temps <- rbind(temps, temps_reg)
sals_reg <- sals_reg[ManagedAreaName %in% mas, ]
sals <- rbind(sals, sals_reg)

temps_reg <- fread(here::here("Combined_WQ_WC_NUT_cont_Water_Temperature_NE-2022-Nov-16.txt"), sep = "|")
sals_reg <- fread(here::here("Combined_WQ_WC_NUT_cont_Salinity_NE-2022-Nov-16.txt"), sep = "|")

temps_reg <- temps_reg[ManagedAreaName %in% mas, ]
temps <- rbind(temps, temps_reg)
sals_reg <- sals_reg[ManagedAreaName %in% mas, ]
sals <- rbind(sals, sals_reg)

temps_reg <- fread(here::here("Combined_WQ_WC_NUT_cont_Water_Temperature_NW-2022-Nov-16.txt"), sep = "|")
sals_reg <- fread(here::here("Combined_WQ_WC_NUT_cont_Salinity_NW-2022-Nov-16.txt"), sep = "|")

temps_reg <- temps_reg[ManagedAreaName %in% mas, ]
temps <- rbind(temps, temps_reg)
sals_reg <- sals_reg[ManagedAreaName %in% mas, ]
sals <- rbind(sals, sals_reg)
rm(temps_reg)
rm(sals_reg)

# 
# library(RcppRoll)
# 
# temps[, `:=` (d7_rollavg = roll_median(ResultValue, n = 96, align = "right", fill = NA),
#               d7_rollmax = roll_max(ResultValue, n = 96, align = "right", fill = NA),
#               d7_rollmin = roll_min(ResultValue, n = 96, align = "right", fill = NA)), by = c("ManagedAreaName", "ProgramLocationID")]
# 
# sals[, `:=` (d7_rollavg = roll_median(ResultValue, n = 96, align = "right", fill = NA),
#              d7_rollmax = roll_max(ResultValue, n = 96, align = "right", fill = NA),
#              d7_rollmin = roll_min(ResultValue, n = 96, align = "right", fill = NA)), by = c("ManagedAreaName", "ProgramLocationID")]


# temps[, SampleDate := as.Date(SampleDate)]
# temps[, `:=` (d7_rollq50 = Expr_rolling_quantile(ResultValue, quantile = 0.5, window_size = "1d", by = "SampleDate"),
#               d7_rollq95 = Expr_rolling_quantile(ResultValue, quantile = 0.95, window_size = "1d", by = "SampleDate"),
#               d7_rollq05 = Expr_rolling_quantile(ResultValue, quantile = 0.05, window_size = "1d", by = "SampleDate")), by = c("ManagedAreaName", "ProgramLocationID")]

temps[, SampleDate := as.character(SampleDate)]

temps2 <- pl$DataFrame(temps)$as_data_frame()
temps2 <- pl$DataFrame(temps)$select(
  pl$col("ResultValue")$rolling_quantile(quantile = 0.5, window_size = 96)$over("ProgramLocationID")$alias("d1_rollq50"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.95, window_size = 96)$over("ProgramLocationID")$alias("d1_rollq95"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.05, window_size = 96)$over("ProgramLocationID")$alias("d1_rollq05"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.5, window_size = 672)$over("ProgramLocationID")$alias("d7_rollq50"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.95, window_size = 672)$over("ProgramLocationID")$alias("d7_rollq95"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.05, window_size = 672)$over("ProgramLocationID")$alias("d7_rollq05"),
  "ParameterName",
  "ParameterUnits",
  "ProgramLocationID",
  "SampleDate",
  "Year",
  "Month",
  "RelativeDepth",
  "TotalDepth_m",
  "ResultValue",
  "ManagedAreaName",
  "Region",
  "SEACAR_EventID",
  "AreaID"
  )$as_data_frame()

setDT(temps2)
temps2[, SampleDate := as.Date(SampleDate)]

eb01_temp2005 <- temps2[ProgramLocationID == "EB01" & Year == 2005, ]
setorder(eb01_temp2005, SampleDate)
eb01_temp2005[, reading := seq(1, nrow(eb01_temp2005))]
# eb01_temp2005[, `:=` (d1_q50p50 = ifelse(d1_rollq50 > median(eb01_temp2005$d1_rollq50, na.rm = TRUE), 1, 0),
#                       d1_q95p50 = ifelse(d1_rollq95 > median(eb01_temp2005$d1_rollq95, na.rm = TRUE), 1, 0),
#                       d1_q05p50 = ifelse(d1_rollq05 > median(eb01_temp2005$d1_rollq05, na.rm = TRUE), 1, 0),
#                       d7_q50p50 = ifelse(d7_rollq50 > median(eb01_temp2005$d7_rollq50, na.rm = TRUE), 1, 0),
#                       d7_q95p50 = ifelse(d7_rollq95 > median(eb01_temp2005$d7_rollq95, na.rm = TRUE), 1, 0),
#                       d7_q05p50 = ifelse(d7_rollq05 > median(eb01_temp2005$d7_rollq05, na.rm = TRUE), 1, 0))]
# eb01_temp2005[, `:=` (d1_q50p50 = ifelse(mean(d1_rollq50) > median(eb01_temp2005$d1_rollq50, na.rm = TRUE), 1, 0),
#                       d1_q95p50 = ifelse(mean(d1_rollq95) > median(eb01_temp2005$d1_rollq95, na.rm = TRUE), 1, 0),
#                       d1_q05p50 = ifelse(mean(d1_rollq05) > median(eb01_temp2005$d1_rollq05, na.rm = TRUE), 1, 0),
#                       d7_q50p50 = ifelse(mean(d7_rollq50) > median(eb01_temp2005$d7_rollq50, na.rm = TRUE), 1, 0),
#                       d7_q95p50 = ifelse(mean(d7_rollq95) > median(eb01_temp2005$d7_rollq95, na.rm = TRUE), 1, 0),
#                       d7_q05p50 = ifelse(mean(d7_rollq05) > median(eb01_temp2005$d7_rollq05, na.rm = TRUE), 1, 0)), by = c("ManagedAreaName", "ProgramLocationID", "SampleDate")]

eb01_temp2005[, `:=` (d1_rollq50_cv = sd(d1_rollq50)/mean(d1_rollq50),
                      d1_rollq95_cv = sd(d1_rollq95)/mean(d1_rollq95),
                      d1_rollq05_cv = sd(d1_rollq05)/mean(d1_rollq05),
                      d7_rollq50_cv = sd(d7_rollq50)/mean(d7_rollq50),
                      d7_rollq95_cv = sd(d7_rollq95)/mean(d7_rollq95),
                      d7_rollq05_cv = sd(d7_rollq05)/mean(d7_rollq05)), by = c("ManagedAreaName", "ProgramLocationID", "SampleDate")]

# temp_p50 <- eb01_temp2005[, `:=` (d1_p50_q50 = ifelse(sum(d1_q50p50)/length(d1_q50p50) > 0.5, 1, 0),
#                                   d1_p50_q95 = ifelse(sum(d1_q95p50)/length(d1_q95p50) > 0.5, 1, 0),
#                                   d1_p50_q05 = ifelse(sum(d1_q05p50)/length(d1_q05p50) > 0.5, 1, 0),
#                                   d7_p50_q50 = ifelse(sum(d7_q50p50)/length(d7_q50p50) > 0.5, 1, 0),
#                                   d7_p50_q95 = ifelse(sum(d7_q95p50)/length(d7_q95p50) > 0.5, 1, 0),
#                                   d7_p50_q05 = ifelse(sum(d7_q05p50)/length(d7_q05p50) > 0.5, 1, 0)), by = c("ManagedAreaName", "ProgramLocationID", "SampleDate")]
# 
# temp_p50 <- eb01_temp2005[, `:=` (d1_p50_q50 = ifelse(sum(d1_q50p50)/length(d1_q50p50) > 0.5, 1, 0),
#                                   d1_p50_q95 = ifelse(sum(d1_q95p50)/length(d1_q95p50) > 0.5, 1, 0),
#                                   d1_p50_q05 = ifelse(sum(d1_q05p50)/length(d1_q05p50) > 0.5, 1, 0),
#                                   d7_p50_q50 = ifelse(sum(d7_q50p50)/length(d7_q50p50) > 0.5, 1, 0),
#                                   d7_p50_q95 = ifelse(sum(d7_q95p50)/length(d7_q95p50) > 0.5, 1, 0),
#                                   d7_p50_q05 = ifelse(sum(d7_q05p50)/length(d7_q05p50) > 0.5, 1, 0)), by = c("ManagedAreaName", "ProgramLocationID", "SampleDate")]
# 
# ggplot(data = temp_p50) +
#   geom_point(aes(x = reading, y = d1_p50_q50), color = "black") +
#   geom_point(aes(x = reading, y = d1_p50_q95), color = "red") +
#   geom_point(aes(x = reading, y = d1_p50_q05), color = "blue") +
#   theme_bw()
# 
# ggplot(data = temp_p50) +
#   geom_point(aes(x = reading, y = d7_p50_q50), color = "black") +
#   geom_point(aes(x = reading, y = d7_p50_q95), color = "red") +
#   geom_point(aes(x = reading, y = d7_p50_q05), color = "blue") +
#   theme_bw()
# 
# ggplot(data = eb01_temp2005) +
#   geom_point(aes(x = reading, y = d1_q50p50), color = "black") +
#   geom_point(aes(x = reading, y = d1_q95p50), color = "red") +
#   geom_point(aes(x = reading, y = d1_q05p50), color = "blue") +
#   theme_bw()


# temp_rolls <- ggplot(data = eb01_temp2005) +
#   geom_point(aes(x = reading, y = d1_rollq50), alpha = 0.15) +
#   geom_point(aes(x = reading, y = d1_rollq95), color = "red", alpha = 0.15) +
#   geom_point(aes(x = reading, y = d1_rollq05), color = "blue", alpha = 0.15) +
#   # geom_point(aes(x = reading, y = d7_rollq50), alpha = 0.15) +
#   # geom_point(aes(x = reading, y = d7_rollq95), color = "red", alpha = 0.15) +
#   # geom_point(aes(x = reading, y = d7_rollq05), color = "blue", alpha = 0.15) +
#   # geom_hline(aes(yintercept = median(eb01_temp2005$d7_rollq50, na.rm = TRUE)), color = "black", lwd = 1.25) +
#   # geom_hline(aes(yintercept = median(eb01_temp2005$d7_rollq95, na.rm = TRUE)), color = "firebrick", lwd = 1.25) +
#   # geom_hline(aes(yintercept = median(eb01_temp2005$d7_rollq05, na.rm = TRUE)), color = "dodgerblue", lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_temp2005$ResultValue, probs = c(0.5))), color = "black", lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_temp2005$ResultValue, probs = c(0.95))), color = "firebrick", lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_temp2005$ResultValue, probs = c(0.05))), color = "dodgerblue", lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_temp2005$ResultValue, probs = c(0.25))), color = "gold", lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_temp2005$ResultValue, probs = c(0.75))), color = "gold", lwd = 1.25) +
#   # geom_point(data = cv_gamfits, aes(x = x, y = q50), color = "gold") +
#   # geom_point(data = cv_gamfits, aes(x = x, y = q95), color = "gold") +
#   # geom_point(data = cv_gamfits, aes(x = x, y = q05), color = "gold") +
#   geom_smooth(aes(x = reading, y = d1_rollq50), color = "white") +
#   geom_smooth(aes(x = reading, y = d1_rollq95), color = "light pink") +
#   geom_smooth(aes(x = reading, y = d1_rollq05), color = "light blue") +
#   theme_bw()
# temp_rolls

temp_rollq <- ggplot(data = eb01_temp2005) +
  geom_point(aes(x = reading, y = d1_rollq50, color = "rollq50"), alpha = 0.15) +
  geom_point(aes(x = reading, y = d1_rollq95, color = "rollq95"), alpha = 0.15) +
  geom_point(aes(x = reading, y = d1_rollq05, color = "rollq05"), alpha = 0.15) +
  # geom_hline(aes(yintercept = temps2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(d1_rollq50), median(d1_rollq50)], color = "medq50"), lwd = 1.25) +
  # geom_hline(aes(yintercept = temps2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(d1_rollq95), median(d1_rollq95)], color = "medq95"), lwd = 1.25) +
  # geom_hline(aes(yintercept = temps2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(d1_rollq05), median(d1_rollq05)], color = "medq05"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005$ResultValue, probs = c(0.5)), color = "rawq50"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005$ResultValue, probs = c(0.95)), color = "rawq95"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005$ResultValue, probs = c(0.05)), color = "rawq05"), lwd = 1.25) +
  geom_smooth(aes(x = reading, y = d1_rollq50, color = "gam50")) +
  geom_smooth(aes(x = reading, y = d1_rollq95, color = "gam95")) +
  geom_smooth(aes(x = reading, y = d1_rollq05, color = "gam05")) +
  scale_color_manual(values = c("rollq50" = "black", "rollq95" = "red", "rollq05" = "blue", "rawq50" = "grey50", "rawq95" = "firebrick", "rawq05" = "dodgerblue", "gam50" = "white", "gam95" = "light pink", "gam05" = "light blue"),
                     labels = c("50%", "95%", "5%", "Raw data 50%", "Raw data 95%", "Raw data 5%", "GAM fit 50%", "GAM fit 95%", "GAM fit 5%")) +
  theme_bw() +
  labs(y = "Temperature (C)") +
  theme(axis.title.x = element_blank(),
        legend.title = element_blank())

temp_cvs <- ggplot(data = eb01_temp2005) +
  geom_point(aes(x = reading, y = d1_rollq50_cv, color = "rollq50"), alpha = 0.15) +
  geom_point(aes(x = reading, y = d1_rollq95_cv, color = "rollq95"), alpha = 0.15) +
  geom_point(aes(x = reading, y = d1_rollq05_cv, color = "rollq05"), alpha = 0.15) +
  geom_smooth(aes(x = reading, y = d1_rollq50_cv, color = "medq50"), alpha = 0.1) +
  geom_smooth(aes(x = reading, y = d1_rollq95_cv, color = "medq95"), alpha = 0.1) +
  geom_smooth(aes(x = reading, y = d1_rollq05_cv, color = "medq05"), alpha = 0.1) +
  # geom_point(data = cv_gamfits, aes(x = x, y = q50), color = "gold") +
  # geom_point(data = cv_gamfits, aes(x = x, y = q95), color = "gold") +
  # geom_point(data = cv_gamfits, aes(x = x, y = q05), color = "gold") +
  scale_color_manual(values = c("rollq50" = "black", "rollq95" = "red", "rollq05" = "blue", "medq50" = "grey50", "medq95" = "firebrick", "medq05" = "dodgerblue"),
                     labels = c("50%", "95%", "5%", "GAM fit 50%", "GAM fit 95%", "GAM fit 5%")) +
  theme_bw() +
  labs(y = "Daily coefficient\nof variation") +
  theme(legend.title = element_blank())

temp_rollq / temp_cvs + plot_layout(guides = "collect") + plot_annotation(tag_levels = c("A", "B"))
```

## Salinity

```{r SeasonDef1s}
#| warning: FALSE
#| error: FALSE
#| label: fig-SeasonDef1s
#| fig-cap: "Plots showing (A) the rolling quantile outputs and GAM fits for 5%, 50%, and 95% quantiles of salinity using a 96-observation window and (B) the coefficient of variation (sd/mean) of observations for each sample date."

# sals[, `:=` (d7_rollavg = roll_median(ResultValue, n = 96, align = "right", fill = NA),
#              d7_rollmax = roll_max(ResultValue, n = 96, align = "right", fill = NA),
#              d7_rollmin = roll_min(ResultValue, n = 96, align = "right", fill = NA)), by = c("ManagedAreaName", "ProgramLocationID")]


  

#Salinity
sals[, SampleDate := as.character(SampleDate)]

sals2 <- pl$DataFrame(sals)$as_data_frame()
sals2 <- pl$DataFrame(sals)$select(
  pl$col("ResultValue")$rolling_quantile(quantile = 0.5, window_size = 96)$over("ProgramLocationID")$alias("sal_d1_rollq50"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.95, window_size = 96)$over("ProgramLocationID")$alias("sal_d1_rollq95"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.05, window_size = 96)$over("ProgramLocationID")$alias("sal_d1_rollq05"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.5, window_size = 288)$over("ProgramLocationID")$alias("sal_d3_rollq50"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.95, window_size = 288)$over("ProgramLocationID")$alias("sal_d3_rollq975"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.05, window_size = 288)$over("ProgramLocationID")$alias("sal_d3_rollq025"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.5, window_size = 672)$over("ProgramLocationID")$alias("sal_d7_rollq50"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.95, window_size = 672)$over("ProgramLocationID")$alias("sal_d7_rollq95"),
  pl$col("ResultValue")$rolling_quantile(quantile = 0.05, window_size = 672)$over("ProgramLocationID")$alias("sal_d7_rollq05"),
  "ParameterName",
  "ParameterUnits",
  "ProgramLocationID",
  "SampleDate",
  "Year",
  "Month",
  "RelativeDepth",
  "TotalDepth_m",
  "ResultValue",
  "ManagedAreaName",
  "Region",
  "SEACAR_EventID",
  "AreaID"
  )$as_data_frame()

setDT(sals2)
sals2[, SampleDate := as.Date(SampleDate)]
eb01_sal2005 <- sals2[ProgramLocationID == "EB01" & Year == 2005, ]
setorder(eb01_sal2005, SampleDate)
eb01_sal2005[, reading := seq(1, nrow(eb01_sal2005))]

# eb01_sal2005[, `:=` (d1_q50p50 = ifelse(d1_rollq50 > median(eb01_sal2005$d1_rollq50, na.rm = TRUE), 1, 0),
#                      d1_q95p50 = ifelse(d1_rollq95 > median(eb01_sal2005$d1_rollq95, na.rm = TRUE), 1, 0),
#                      d1_q05p50 = ifelse(d1_rollq05 > median(eb01_sal2005$d1_rollq05, na.rm = TRUE), 1, 0),
#                      d7_q50p50 = ifelse(d7_rollq50 > median(eb01_sal2005$d7_rollq50, na.rm = TRUE), 1, 0),
#                      d7_q95p50 = ifelse(d7_rollq95 > median(eb01_sal2005$d7_rollq95, na.rm = TRUE), 1, 0),
#                      d7_q05p50 = ifelse(d7_rollq05 > median(eb01_sal2005$d7_rollq05, na.rm = TRUE), 1, 0)), by = row.names(eb01_sal2005)]
# 
# sal_p50 <- eb01_sal2005 %>% group_by(ManagedAreaName, ProgramLocationID, SampleDate) %>% 
#   summarise(d1_p50_q50 = ifelse(sum(d1_q50p50)/length(d1_q50p50) > 0.5, 1, 0),
#             d1_p50_q95 = ifelse(sum(d1_q95p50)/length(d1_q95p50) > 0.5, 1, 0),
#             d1_p50_q05 = ifelse(sum(d1_q05p50)/length(d1_q05p50) > 0.5, 1, 0),
#             d7_p50_q50 = ifelse(sum(d7_q50p50)/length(d7_q50p50) > 0.5, 1, 0),
#             d7_p50_q95 = ifelse(sum(d7_q95p50)/length(d7_q95p50) > 0.5, 1, 0),
#             d7_p50_q05 = ifelse(sum(d7_q05p50)/length(d7_q05p50) > 0.5, 1, 0))
# 
# ggplot(data = sal_p50) +
#   geom_line(aes(x = SampleDate, y = d1_p50_q50), color = "black") +
#   geom_line(aes(x = SampleDate, y = d1_p50_q95), color = "red") +
#   geom_line(aes(x = SampleDate, y = d1_p50_q05), color = "blue") +
#   theme_bw()
# 
# ggplot(data = sal_p50) +
#   geom_point(aes(x = SampleDate, y = d7_p50_q50), color = "black") +
#   geom_point(aes(x = SampleDate, y = d7_p50_q95), color = "red") +
#   geom_point(aes(x = SampleDate, y = d7_p50_q05), color = "blue") +
#   theme_bw()
# 
# 
# ggplot(data = sals2[ProgramLocationID == "EB01" & Year == 2005, ]) +
#   geom_point(aes(x = SampleDate, y = d1_rollq50), alpha = 0.15) +
#   geom_point(aes(x = SampleDate, y = d1_rollq95), color = "red", alpha = 0.15) +
#   geom_point(aes(x = SampleDate, y = d1_rollq05), color = "blue", alpha = 0.15) +
#   geom_hline(aes(yintercept = sals2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(d1_rollq50), median(d1_rollq50)]), color = "black", lwd = 1.25) +
#   geom_hline(aes(yintercept = sals2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(d1_rollq95), median(d1_rollq95)]), color = "firebrick", lwd = 1.25) +
#   geom_hline(aes(yintercept = sals2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(d1_rollq05), median(d1_rollq05)]), color = "dodgerblue", lwd = 1.25) +
#   theme_bw()
# 
# 
# ggplot(data = eb01_sal2005) +
#   geom_point(aes(x = SampleDate, y = d7_rollq50), alpha = 0.15) +
#   geom_point(aes(x = SampleDate, y = d7_rollq95), color = "red", alpha = 0.15) +
#   geom_point(aes(x = SampleDate, y = d7_rollq05), color = "blue", alpha = 0.15) +
#   # geom_hline(aes(yintercept = median(eb01_sal2005$d7_rollq50, na.rm = TRUE)), color = "black", lwd = 1.25) +
#   # geom_hline(aes(yintercept = median(eb01_sal2005$d7_rollq95, na.rm = TRUE)), color = "firebrick", lwd = 1.25) +
#   # geom_hline(aes(yintercept = median(eb01_sal2005$d7_rollq05, na.rm = TRUE)), color = "dodgerblue", lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_sal2005$ResultValue, probs = c(0.5))), color = "black", lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_sal2005$ResultValue, probs = c(0.95))), color = "firebrick", lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_sal2005$ResultValue, probs = c(0.05))), color = "dodgerblue", lwd = 1.25) +
#   theme_bw()



eb01_sal2005[, `:=` (sal_d1_rollq50_cv = sd(sal_d1_rollq50)/mean(sal_d1_rollq50),
                     sal_d1_rollq95_cv = sd(sal_d1_rollq95)/mean(sal_d1_rollq95),
                     sal_d1_rollq05_cv = sd(sal_d1_rollq05)/mean(sal_d1_rollq05)), by = c("ManagedAreaName", "ProgramLocationID", "SampleDate")]
                     # d3_rollq50_cv = sd(d3_rollq50)/mean(d3_rollq50),
                     # d3_rollq975_cv = sd(d3_rollq975)/mean(d3_rollq975),
                     # d3_rollq025_cv = sd(d3_rollq025)/mean(d3_rollq025)), by = c("ManagedAreaName", "ProgramLocationID", "SampleDate")]
                     # d7_rollq50_cv = sd(d7_rollq50)/mean(d7_rollq50),
                     # d7_rollq95_cv = sd(d7_rollq95)/mean(d7_rollq95),
                     # d7_rollq05_cv = sd(d7_rollq05)/mean(d7_rollq05)), by = c("ManagedAreaName", "ProgramLocationID", "SampleDate")]

sal_cvs <- ggplot(data = eb01_sal2005) +
  geom_point(aes(x = reading, y = sal_d1_rollq50_cv), color = "black", alpha = 0.15) +
  geom_point(aes(x = reading, y = sal_d1_rollq95_cv), color = "red", alpha = 0.15) +
  geom_point(aes(x = reading, y = sal_d1_rollq05_cv), color = "blue", alpha = 0.15) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq50_cv), color = "black", alpha = 0.1) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq95_cv), color = "red", alpha = 0.1) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq05_cv), color = "blue", alpha = 0.1) +
  # geom_point(aes(x = reading, y = sal_d3_rollq50_cv), color = "black", alpha = 0.15) +
  # geom_point(aes(x = reading, y = sal_d3_rollq975_cv), color = "red", alpha = 0.15) +
  # geom_point(aes(x = reading, y = sal_d3_rollq025_cv), color = "blue", alpha = 0.15) +
  # geom_smooth(aes(x = reading, y = sal_d3_rollq50_cv), color = "black", alpha = 0.1) +
  # geom_smooth(aes(x = reading, y = sal_d3_rollq975_cv), color = "red", alpha = 0.1) +
  # geom_smooth(aes(x = reading, y = sal_d3_rollq025_cv), color = "blue", alpha = 0.1) +
  # geom_point(data = cv_gamfits, aes(x = x, y = q50), color = "gold") +
  # geom_point(data = cv_gamfits, aes(x = x, y = q95), color = "gold") +
  # geom_point(data = cv_gamfits, aes(x = x, y = q05), color = "gold") +
  theme_bw() #+
  # coord_cartesian(xlim = c(1, 5))

sal_rollq <- ggplot(data = eb01_sal2005) +
  geom_point(aes(x = reading, y = sal_d1_rollq50, color = "rollq50"), alpha = 0.15) +
  geom_point(aes(x = reading, y = sal_d1_rollq95, color = "rollq95"), alpha = 0.15) +
  geom_point(aes(x = reading, y = sal_d1_rollq05, color = "rollq05"), alpha = 0.15) +
  # geom_hline(aes(yintercept = temps2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(sal_d1_rollq50), median(sal_d1_rollq50)], color = "medq50"), lwd = 1.25) +
  # geom_hline(aes(yintercept = temps2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(sal_d1_rollq95), median(sal_d1_rollq95)], color = "medq95"), lwd = 1.25) +
  # geom_hline(aes(yintercept = temps2[ProgramLocationID == "EB01" & Year == 2005 & !is.na(sal_d1_rollq05), median(sal_d1_rollq05)], color = "medq05"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005$ResultValue, probs = c(0.5)), color = "rawq50"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005$ResultValue, probs = c(0.95)), color = "rawq95"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005$ResultValue, probs = c(0.05)), color = "rawq05"), lwd = 1.25) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq50, color = "gam50")) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq95, color = "gam95")) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq05, color = "gam05")) +
  scale_color_manual(values = c("rollq50" = "black", "rollq95" = "red", "rollq05" = "blue", "rawq50" = "grey50", "rawq95" = "firebrick", "rawq05" = "dodgerblue", "gam50" = "white", "gam95" = "light pink", "gam05" = "light blue"),
                     labels = c("50%", "95%", "5%", "Raw data 50%", "Raw data 95%", "Raw data 5%", "GAM fit 50%", "GAM fit 95%", "GAM fit 5%")) +
  theme_bw() +
  labs(y = "Salinity (ppt)") +
  theme(axis.title.x = element_blank(),
        legend.title = element_blank())

sal_cvs <- ggplot(data = eb01_sal2005) +
  geom_point(aes(x = reading, y = sal_d1_rollq50_cv, color = "rollq50"), alpha = 0.15) +
  geom_point(aes(x = reading, y = sal_d1_rollq95_cv, color = "rollq95"), alpha = 0.15) +
  geom_point(aes(x = reading, y = sal_d1_rollq05_cv, color = "rollq05"), alpha = 0.15) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq50_cv, color = "medq50"), alpha = 0.1) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq95_cv, color = "medq95"), alpha = 0.1) +
  geom_smooth(aes(x = reading, y = sal_d1_rollq05_cv, color = "medq05"), alpha = 0.1) +
  scale_color_manual(values = c("rollq50" = "black", "rollq95" = "red", "rollq05" = "blue", "medq50" = "grey50", "medq95" = "firebrick", "medq05" = "dodgerblue"),
                     labels = c("50%", "95%", "5%", "GAM fit 50%", "GAM fit 95%", "GAM fit 5%")) +
  theme_bw() +
  labs(y = "Daily coefficient\nof variation") +
  theme(legend.title = element_blank())

sal_rollq / sal_cvs + plot_layout(guides = "collect") + plot_annotation(tag_levels = c("A", "B"))

```

:::

<br>

In order to accentuate the seasonal signal, I scaled the rolling quantiles and the CV GAM fits and then subtracted each scaled CV GAM fit value from the closest corresponding scaled rolling quantile value (#fig-SeasonDef3).

::: {.panel-tabset}

## Temperature

```{r SeasonDef3}
#| warning: FALSE
#| error: FALSE
#| label: fig-SeasonDef3
#| fig-cap: "Plot showing the difference of the rolling quantile values and corresonding scaled CV values for temperature for each day, along with the 5%, 50%, and 95% quantiles of the scaled raw temperature data for the entire timeseries."

cv_gamfits <- ggplot_build(temp_cvs)$data[[4]]
cv_gamfits_q95 <- ggplot_build(temp_cvs)$data[[5]]
cv_gamfits_q05 <- ggplot_build(temp_cvs)$data[[6]]

setDT(cv_gamfits)
cv_gamfits <- cv_gamfits[, .(x, y)]
setnames(cv_gamfits, "y", "q50")

setDT(cv_gamfits_q05)
cv_gamfits_q05 <- cv_gamfits_q05[, .(x, y)]
setnames(cv_gamfits_q05, "y", "q05")

setDT(cv_gamfits_q95)
cv_gamfits_q95 <- cv_gamfits_q95[, .(x, y)]
setnames(cv_gamfits_q95, "y", "q95")


cv_gamfits <- merge(cv_gamfits, cv_gamfits_q05)
cv_gamfits <- merge(cv_gamfits, cv_gamfits_q95)
# cv_gamfits[, season := ifelse(min(c(q05, q50, q95)) == q05, "winter", 
#                               ifelse(min(c(q05, q50, q95)) == q95, "summer", 
#                                      ifelse(min(c(q05, q50, q95)) == q50 & (max(eb01_temp2005$reading) - x)/max(eb01_temp2005$reading) > 0.5, "spring", "fall"))), by = row.names(cv_gamfits)]

cv_gamfits_l <- melt(cv_gamfits, id.vars = c("x"), measure.vars = c("q50", "q05", "q95"))
cv_gamfits_l[, variable := factor(variable, levels = c("q95", "q50", "q05"))]
cv_gamfits_l[, x := round(x)]

eb01_temp2005_l <- melt(eb01_temp2005[, .(SampleDate, Year, Month, TotalDepth_m, ResultValue, ManagedAreaName, reading, d1_rollq50, d1_rollq95, d1_rollq05)], id.vars = c("SampleDate", "Year", "Month", "TotalDepth_m", "ResultValue", "ManagedAreaName", "reading"), measure.vars = c("d1_rollq50", "d1_rollq05", "d1_rollq95"))
eb01_temp2005_l[, variable := factor(fcase(str_detect(variable, "q50"), "q50",
                                    str_detect(variable, "q05"), "q05",
                                    str_detect(variable, "q95"), "q95"), levels = c("q95", "q50", "q05")), by = variable]

setnames(cv_gamfits_l, "x", "reading")

eb01_temp2005_l_wcv <- merge(eb01_temp2005_l, cv_gamfits_l, by = c("reading", "variable"), all.x = TRUE, all.y = TRUE)
setnames(eb01_temp2005_l_wcv, c("value.x", "value.y", "variable"), c("d1_roll", "cv_gamfits", "quantile"))

eb01_temp2005_l_wcv[, `:=` (d1_roll_r = scale(d1_roll, center = TRUE), cv_gamfits_r = scale(cv_gamfits, center = TRUE), ResultValue_r = scale(ResultValue, center = TRUE))]
eb01_temp2005_l_wcv[!is.na(cv_gamfits_r), combtest := d1_roll_r - cv_gamfits_r]

# temp_rolls2 <- ggplot(data = eb01_temp2005_l_wcv) +
#   # geom_point(aes(x = reading, y = d1_roll_r, color = quantile), alpha = 0.1) +
#   geom_line(data = eb01_temp2005_l_wcv[!is.na(cv_gamfits_r), ], aes(x = reading, y = cv_gamfits_r, color = quantile), lty = "dashed", lwd = 0.75) +
#   geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE), color = unique(quantile[2])), lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), color = unique(quantile[3])), lwd = 1.25) +
#   geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE), color = unique(quantile[1])), lwd = 1.25) +
#   geom_smooth(aes(x = reading, y = d1_roll_r, color = quantile)) +
#   theme_bw()
# temp_rolls2

temp_rolls3 <- ggplot(data = eb01_temp2005_l_wcv) +
  # geom_point(aes(x = reading, y = d1_roll_r, color = quantile), alpha = 0.1) +
  geom_line(data = eb01_temp2005_l_wcv[!is.na(combtest), ], aes(x = reading, y = combtest, color = quantile), lwd = 0.75) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE), color = "raw50"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), color = "raw05"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE), color = "raw95"), lwd = 1.25) +
  # geom_smooth(aes(x = reading, y = d1_roll_r, color = quantile)) +
  geom_smooth(data = eb01_temp2005_l_wcv[!is.na(combtest), ], aes(x = reading, y = combtest, color = quantile), lwd = 0.75) +
  theme_bw() +
  scale_color_manual(values = c("q50" = "black", "q95" = "red", "q05" = "blue", "raw50" = "grey50", "raw95" = "firebrick", "raw05" = "dodgerblue"),
                     labels = c("Loess 50%", "Loess 95%", "Loess 5%", "Scaled raw data 50%", "Scaled raw data 95%", "Scaled raw data 5%")) +
  labs(y = "Difference\n(scaled rolling quantile - scaled CV)") +
  theme(legend.title = element_blank())
temp_rolls3


```

## Salinity

```{r SeasonDef3s}
#| warning: FALSE
#| error: FALSE
#| label: fig-SeasonDef3s
#| fig-cap: "Plot showing the difference of the rolling quantile values and corresonding scaled CV values for salinity for each day, along with the 5%, 50%, and 95% quantiles of the scaled raw salinity data for the entire timeseries."


cv_gamfits_sal <- ggplot_build(sal_cvs)$data[[4]]
cv_gamfits_q95_sal <- ggplot_build(sal_cvs)$data[[5]]
cv_gamfits_q05_sal <- ggplot_build(sal_cvs)$data[[6]]

setDT(cv_gamfits_sal)
cv_gamfits_sal <- cv_gamfits_sal[, .(x, y)]
setnames(cv_gamfits_sal, "y", "q50")

setDT(cv_gamfits_q05_sal)
cv_gamfits_q05_sal <- cv_gamfits_q05_sal[, .(x, y)]
setnames(cv_gamfits_q05_sal, "y", "q05")
# setnames(cv_gamfits_q05_sal, "y", "q025")

setDT(cv_gamfits_q95_sal)
cv_gamfits_q95_sal <- cv_gamfits_q95_sal[, .(x, y)]
setnames(cv_gamfits_q95_sal, "y", "q95")
# setnames(cv_gamfits_q95_sal, "y", "q975")


cv_gamfits_sal <- merge(cv_gamfits_sal, cv_gamfits_q05_sal)
cv_gamfits_sal <- merge(cv_gamfits_sal, cv_gamfits_q95_sal)
# cv_gamfits_sal[, season := ifelse(min(c(q05, q50, q95)) == q05, "winter", 
#                                   ifelse(min(c(q05, q50, q95)) == q95, "summer", 
#                                          ifelse(min(c(q05, q50, q95)) == q50 & (max(eb01_sal2005$reading) - x)/max(eb01_sal2005$reading) > 0.5, "spring", "fall"))), by = row.names(cv_gamfits_sal)]


cv_gamfits_sal_l <- melt(cv_gamfits_sal, id.vars = c("x"), measure.vars = c("q50", "q05", "q95"))
cv_gamfits_sal_l[, variable := factor(variable, levels = c("q95", "q50", "q05"))]
# cv_gamfits_sal_l <- melt(cv_gamfits_sal, id.vars = c("x"), measure.vars = c("q50", "q025", "q975"))
# cv_gamfits_sal_l[, variable := factor(variable, levels = c("q975", "q50", "q025"))]
cv_gamfits_sal_l[, x := round(x)]

eb01_sal2005_l <- melt(eb01_sal2005[, .(SampleDate, Year, Month, TotalDepth_m, ResultValue, ManagedAreaName, reading, sal_d1_rollq50, sal_d1_rollq95, sal_d1_rollq05)], id.vars = c("SampleDate", "Year", "Month", "TotalDepth_m", "ResultValue", "ManagedAreaName", "reading"), measure.vars = c("sal_d1_rollq50", "sal_d1_rollq05", "sal_d1_rollq95"))
eb01_sal2005_l[, variable := factor(fcase(str_detect(variable, "q50"), "q50",
                                    str_detect(variable, "q05"), "q05",
                                    str_detect(variable, "q95"), "q95"), levels = c("q95", "q50", "q05")), by = variable]

# eb01_sal2005_l <- melt(eb01_sal2005[, .(SampleDate, Year, Month, TotalDepth_m, ResultValue, ManagedAreaName, reading, d3_rollq50, d3_rollq975, d3_rollq025)], id.vars = c("SampleDate", "Year", "Month", "TotalDepth_m", "ResultValue", "ManagedAreaName", "reading"), measure.vars = c("d3_rollq50", "d3_rollq025", "d3_rollq975"))
# eb01_sal2005_l[, variable := factor(fcase(str_detect(variable, "q50"), "q50",
#                                     str_detect(variable, "q025"), "q025",
#                                     str_detect(variable, "q975"), "q975"), levels = c("q975", "q50", "q025")), by = variable]

setnames(cv_gamfits_sal_l, "x", "reading")

eb01_sal2005_l_wcv <- merge(eb01_sal2005_l, cv_gamfits_sal_l, by = c("reading", "variable"), all.x = TRUE, all.y = TRUE)
setnames(eb01_sal2005_l_wcv, c("value.x", "value.y", "variable"), c("d1_roll", "cv_gamfits", "quantile"))

eb01_sal2005_l_wcv[, `:=` (d1_roll_r = scale(d1_roll, center = TRUE), cv_gamfits_r = scale(cv_gamfits, center = TRUE), ResultValue_r = scale(ResultValue, center = TRUE))]
eb01_sal2005_l_wcv[!is.na(cv_gamfits_r), combtest := d1_roll_r - cv_gamfits_r]

sal_rolls3 <- ggplot(data = eb01_sal2005_l_wcv) +
  # geom_point(aes(x = reading, y = sal_d1_roll_r, color = quantile), alpha = 0.1) +
  geom_line(data = eb01_sal2005_l_wcv[!is.na(combtest), ], aes(x = reading, y = combtest, color = quantile), lwd = 0.75) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE), color = "raw50"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), color = "raw05"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE), color = "raw95"), lwd = 1.25) +
  # geom_smooth(aes(x = reading, y = sal_d1_roll_r, color = quantile)) +
  geom_smooth(data = eb01_sal2005_l_wcv[!is.na(combtest), ], aes(x = reading, y = combtest, color = quantile), lwd = 0.75) +
  theme_bw() +
  scale_color_manual(values = c("q50" = "black", "q95" = "red", "q05" = "blue", "raw50" = "grey50", "raw95" = "firebrick", "raw05" = "dodgerblue"),
                     labels = c("Loess 50%", "Loess 95%", "Loess 5%", "Scaled raw data 50%", "Scaled raw data 95%", "Scaled raw data 5%")) +
  labs(y = "Difference\n(scaled rolling quantile - scaled CV)") +
  theme(legend.title = element_blank())
sal_rolls3


```

:::

<br>

The relationship between the seasonal signals (Loess fit to the difference values) and the scaled time series quantile values was improved, and the Loess fit uncertainties presented an opportunity to include some flexibility in the rules for assigning seasons to the time series. I drafted possible rules for illustrative purposes here, based on the combination of quantile Loess fits that are above, nearly below, nearly above, and/or below their corresponding time series quantile values. The Loess uncertainties were used to define "nearly below" and "nearly above", i.e., the Loess fit line was still above or below the corresponding time series quantile value, respectively, but the time series quantile value was within the fit's uncertainty ribbon. These rules produced four seasons; "winter", "spring", "summer", and "fall" seasons for temperature and "dry", "wetter", "wet", and "drier" seasons for salinity (#fig-SeasonDef4).


::: {.panel-tabset}

## Temperature

```{r SeasonDef4}
#| warning: FALSE
#| error: FALSE
#| label: fig-SeasonDef4
#| fig-cap: "Plot from #fig-SeasonDef3 with color-shaded regions to show the season determinations (winter 1 (blue) = ends Apr 19, spring (green) = Apr 19 to May 11, summer (red) = May 11 to Nov 2, fall (yellow) = Nov 2 to Nov 24, winter 2 (blue) = begins Nov 24)."

#!expr glue::glue(\"Plot from #fig-SeasonDef3 with color-shaded regions to show the season determinations (dry = ends {month(dates_temp[1], label = TRUE)} {day(dates_temp[1])}, wetter = {month(dates_temp[1], label = TRUE)} {day(dates_temp[1])} to {month(dates_temp[2], label = TRUE)} {day(dates_temp[2])}, wet = {month(dates_temp[2], label = TRUE)} {day(dates_temp[2])} to {month(dates_temp[3], label = TRUE)} {day(dates_temp[3])}, drier = {ifelse(tr3dat_temp_w[season == \"drier\", max(x)] == max(tr3dat_temp_w$x), paste0(\"begins \", month(dates_temp[3], label = TRUE), \" \", day(dates_temp[3])), paste0(month(dates_temp[3], label = TRUE), \" \", day(dates_temp[3]), \" to \", month(dates_temp[4], label = TRUE), \" \", day(dates_temp[4])))}).\")

tr3dat_temp <- setDT(ggplot_build(temp_rolls3)$data[[5]])
tr3dat_temp[, quantile := fcase(colour == "red", "q95",
                                colour == "black", "q50",
                                colour == "blue", "q05"), by = colour]

tr3dat_temp_w <- setDT(pivot_wider(tr3dat_temp, id_cols = c("x"), names_from = c("quantile"), values_from = c("y", "ymin", "ymax")))
tr3dat_temp_w[, `:=` (SampleDate = eb01_temp2005_l_wcv[reading == round(x), unique(SampleDate)],
                      Year = eb01_temp2005_l_wcv[reading == round(x), unique(Year)],
                      Month = eb01_temp2005_l_wcv[reading == round(x), unique(Month)]), by = x]

for(s in unique(tr3dat_temp_w$x)){
  if(which(tr3dat_temp_w$x == s) == 1){ 
    if(tr3dat_temp_w[x == s, Month] %in% c(3:9)){
      tr3dat_temp_w[x == s, season := fcase(y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer"
                                                 ) 
                                          )]
      
    } else{
      tr3dat_temp_w[x == s, season := fcase(y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                                 
                                                 ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                                 
                                                 ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                                 
                                                 ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                                 
                                                 ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                                 ) 
                                          )]
    }
  }
  # if(tr3dat_temp_w[x == s, Month] <= 6){
  if(length(setdiff(tr3dat_temp_w[min(which(Year == tr3dat_temp_w[x == s, Year])):(which(x == s) - 1), unique(season)],
                    c("winter", "spring"))) == 0){
    tr3dat_temp_w[x == s, season := fcase(y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring"
                                               ),
                                         
                                         y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring"
                                               ),
                                         
                                         y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring"
                                               ),
                                         
                                         y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer"
                                               ),
                                         
                                         y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                               ),
                                         
                                         y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring"
                                               ),
                                         
                                         y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                               ),
                                         
                                         y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "spring",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                               ) 
                                        )]
    
  } else{
    tr3dat_temp_w[x == s, season := fcase(y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall"
                                               ),
                                         
                                         y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall"
                                               ),
                                         
                                         y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall"
                                               ),
                                         
                                         y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                               ),
                                         
                                         y_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "summer",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymin_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymin_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                               ),
                                         
                                         y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall"
                                               ),
                                         
                                         y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                               ),
                                         
                                         y_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter",
                                               
                                               ymax_q95 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "fall",
                                               
                                               ymax_q95 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "winter"
                                               ) 
                                        )]
  }
}


transitions_temp <- c(tr3dat_temp_w[season == "winter" & x < tr3dat_temp_w[season == "spring", min(x)], max(x)] + (tr3dat_temp_w[season == "spring", min(x)] - tr3dat_temp_w[season == "winter" & x < tr3dat_temp_w[season == "spring", min(x)], max(x)])/2,
                 tr3dat_temp_w[season == "spring", max(x)] + (tr3dat_temp_w[season == "summer", min(x)] - tr3dat_temp_w[season == "spring", max(x)])/2,
                 tr3dat_temp_w[season == "summer", max(x)] + (tr3dat_temp_w[season == "fall", min(x)] - tr3dat_temp_w[season == "summer", max(x)])/2,
                 ifelse(tr3dat_temp_w[season == "fall", max(x)] == max(tr3dat_temp_w$x), tr3dat_temp_w[season == "fall", max(x)], tr3dat_temp_w[season == "fall", max(x)] + (tr3dat_temp_w[season == "winter" & x > tr3dat_temp_w[season == "fall", max(x)], min(x)] - tr3dat_temp_w[season == "fall", max(x)])/2))

dates_temp <- eb01_temp2005_l_wcv[reading %in% round(transitions_temp), unique(SampleDate)]

rectymin <- floor(min(eb01_temp2005_l_wcv[!is.na(combtest), combtest])) - 0.5
rectymax <- ceiling(max(eb01_temp2005_l_wcv[!is.na(combtest), combtest])) + 0.5
viewymin <- floor(min(eb01_temp2005_l_wcv[!is.na(combtest), combtest]))
viewymax <- ceiling(max(eb01_temp2005_l_wcv[!is.na(combtest), combtest]))

temp_rolls3b <- ggplot(data = eb01_temp2005_l_wcv) +
  # geom_point(aes(x = reading, y = d1_roll_r, color = quantile), alpha = 0.1) +
  geom_line(data = eb01_temp2005_l_wcv[!is.na(combtest), ], aes(x = reading, y = combtest, color = quantile), lwd = 0.75) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE), color = "raw50"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), color = "raw05"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_temp2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE), color = "raw95"), lwd = 1.25) +
  # geom_smooth(aes(x = reading, y = d1_roll_r, color = quantile)) +
  geom_smooth(data = eb01_temp2005_l_wcv[!is.na(combtest), ], aes(x = reading, y = combtest, color = quantile), lwd = 0.75) +
  # geom_vline(xintercept = transitions_temp) +
  {if(transitions_temp[4] == max(tr3dat_temp_w$x)){
    list(geom_rect(aes(xmin = 1, xmax = transitions_temp[1], ymin = rectymin, ymax = rectymax), fill = "lightblue", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_temp[1], xmax = transitions_temp[2], ymin = rectymin, ymax = rectymax), fill = "palegreen", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_temp[2], xmax = transitions_temp[3], ymin = rectymin, ymax = rectymax), fill = "tomato", alpha = 0.008, color = "grey20"),
    geom_rect(aes(xmin = transitions_temp[3], xmax = transitions_temp[4], ymin = rectymin, ymax = rectymax), fill = "lightgoldenrod", alpha = 0.01, color = "grey20"))
  } else{
    list(geom_rect(aes(xmin = 1, xmax = transitions_temp[1], ymin = rectymin, ymax = rectymax), fill = "lightblue", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_temp[1], xmax = transitions_temp[2], ymin = rectymin, ymax = rectymax), fill = "palegreen", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_temp[2], xmax = transitions_temp[3], ymin = rectymin, ymax = rectymax), fill = "tomato", alpha = 0.008, color = "grey20"),
    geom_rect(aes(xmin = transitions_temp[3], xmax = transitions_temp[4], ymin = rectymin, ymax = rectymax), fill = "lightgoldenrod", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_temp[4], xmax = max(tr3dat_temp_w$x), ymin = rectymin, ymax = rectymax), fill = "lightblue", alpha = 0.01, color = "grey20"))
  }} +
  theme_bw() +
  coord_cartesian(ylim = c(viewymin, viewymax)) +
  scale_color_manual(values = c("q50" = "black", "q95" = "red", "q05" = "blue", "raw50" = "grey50", "raw95" = "firebrick", "raw05" = "dodgerblue"),
                     labels = c("Loess 50%", "Loess 95%", "Loess 5%", "Scaled raw data 50%", "Scaled raw data 95%", "Scaled raw data 5%")) +
  labs(y = "Difference\n(scaled rolling quantile - scaled CV)") +
  theme(legend.title = element_blank())
temp_rolls3b

```

## Salinity

```{r SeasonDef4s}
#| warning: FALSE
#| error: FALSE
#| label: fig-SeasonDef4s
#| fig-cap: "Plot from #fig-SeasonDef3s with color-shaded regions to show the season determinations (dry (blue) = ends May 8, wetter (green) = May 8 to Jul 1, wet (red) = Jul 1 to Nov 2, drier (yellow) = begins Nov 2)."

#!expr glue::glue(\"Plot from {#fig-SeasonDef3s} with color-shaded regions to show the season determinations (dry = ends {month(dates_sal[1], label = TRUE)} {day(dates_sal[1])}, wetter = {month(dates_sal[1], label = TRUE)} {day(dates_sal[1])} to {month(dates_sal[2], label = TRUE)} {day(dates_sal[2])}, wet = {month(dates_sal[2], label = TRUE)} {day(dates_sal[2])} to {month(dates_sal[3], label = TRUE)} {day(dates_sal[3])}, drier = {ifelse(tr3dat_sal_w[season == \"drier\", max(x)] == max(tr3dat_sal_w$x), paste0(\"begins \", month(dates_sal[3], label = TRUE), \" \", day(dates_sal[3])), paste0(month(dates_sal[3], label = TRUE), \" \", day(dates_sal[3]), \" to \", month(dates_sal[4], label = TRUE), \" \", day(dates_sal[4])))}).\")

# for(ex in seq_along(tr3dat_sal_w$x)){
#   if(ex == 1) next
#   
#   tr3dat_sal_w[ex, `:=` (ltor_q95 = fcase(tr3dat_sal_w$y_q95[ex] - tr3dat_sal_w$y_q95[ex - 1] < 0, "neg", 
#                                           tr3dat_sal_w$y_q95[ex] - tr3dat_sal_w$y_q95[ex - 1] > 0, "pos"),
#                          ltor_q50 = fcase(tr3dat_sal_w$y_q50[ex] - tr3dat_sal_w$y_q50[ex - 1] < 0, "neg", 
#                                           tr3dat_sal_w$y_q50[ex] - tr3dat_sal_w$y_q50[ex - 1] > 0, "pos"),
#                          ltor_q05 = fcase(tr3dat_sal_w$y_q05[ex] - tr3dat_sal_w$y_q05[ex - 1] < 0, "neg", 
#                                           tr3dat_sal_w$y_q05[ex] - tr3dat_sal_w$y_q05[ex - 1] > 0, "pos"))]
# }
# tr3dat_sal_w[1, `:=` (ltor_q95 = tr3dat_sal_w$ltor_q95[2],
#                       ltor_q50 = tr3dat_sal_w$ltor_q50[2],
#                       ltor_q05 = tr3dat_sal_w$ltor_q05[2])]


tr3dat_sal <- setDT(ggplot_build(sal_rolls3)$data[[5]])
tr3dat_sal[, quantile := fcase(colour == "red", "q95",
                                colour == "black", "q50",
                                colour == "blue", "q05"), by = colour]
# tr3dat_sal[, quantile := fcase(colour == "#F8766D", "q975",
#                                colour == "#00BA38", "q50",
#                                colour == "#619CFF", "q025"), by = colour]

tr3dat_sal_w <- setDT(pivot_wider(tr3dat_sal, id_cols = c("x"), names_from = c("quantile"), values_from = c("y", "ymin", "ymax")))
tr3dat_sal_w[, `:=` (SampleDate = eb01_sal2005_l_wcv[reading == round(x), unique(SampleDate)],
                     Year = eb01_sal2005_l_wcv[reading == round(x), unique(Year)],
                     Month = eb01_sal2005_l_wcv[reading == round(x), unique(Month)]), by = x]

for(s in unique(tr3dat_sal_w$x)){
  if(which(tr3dat_sal_w$x == s) == 1){ 
    if(tr3dat_sal_w[x == s, Month] %in% c(3:7)){
      tr3dat_sal_w[x == s, season := fcase(y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                                 ) 
                                          )]
      
    } else{
      tr3dat_sal_w[x == s, season := fcase(y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                                 ),
                                           
                                           y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                                 ),
                                           
                                           y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                           & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                           & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                           fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                                 
                                                 ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                                 
                                                 ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                                 ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                                 ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                                 ) 
                                          )]
    }
  }
  # if(tr3dat_sal_w[x == s, Month] <= 6){
  if(length(setdiff(tr3dat_sal_w[min(which(Year == tr3dat_sal_w[x == s, Year])):(which(x == s) - 1), unique(season)],
                    c("dry", "wetter"))) == 0){
    tr3dat_sal_w[x == s, season := fcase(y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter"
                                               ),
                                         
                                         y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter"
                                               ),
                                         
                                         y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter"
                                               ),
                                         
                                         y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                               ),
                                         
                                         y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                               ),
                                         
                                         y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter"
                                               ),
                                         
                                         y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                               ),
                                         
                                         y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wetter",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                               ) 
                                        )]
    
  } else{
    tr3dat_sal_w[x == s, season := fcase(y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier"
                                               ),
                                         
                                         y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier"
                                               ),
                                         
                                         y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier"
                                               ),
                                         
                                         y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "dry",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                               ),
                                         
                                         y_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymin_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymin_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                               ),
                                         
                                         y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymax_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier"
                                               ),
                                         
                                         y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymin_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                               ),
                                         
                                         y_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) 
                                         & y_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) 
                                         & y_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE),
                                         fcase(ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet",
                                               
                                               ymax_q95 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "drier",
                                               
                                               ymax_q95 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE) &
                                               ymax_q50 < quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE) &
                                               ymin_q05 > quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), "wet"
                                               ) 
                                        )]
  }
}

transitions_sal <- c(tr3dat_sal_w[season == "dry" & x < tr3dat_sal_w[season == "wetter", min(x)], max(x)] + (tr3dat_sal_w[season == "wetter", min(x)] - tr3dat_sal_w[season == "dry" & x < tr3dat_sal_w[season == "wetter", min(x)], max(x)])/2,
                     tr3dat_sal_w[season == "wetter", max(x)] + (tr3dat_sal_w[season == "wet", min(x)] - tr3dat_sal_w[season == "wetter", max(x)])/2,
                     tr3dat_sal_w[season == "wet", max(x)] + (tr3dat_sal_w[season == "drier", min(x)] - tr3dat_sal_w[season == "wet", max(x)])/2,
                     ifelse(tr3dat_sal_w[season == "drier", max(x)] == max(tr3dat_sal_w$x), tr3dat_sal_w[season == "drier", max(x)], tr3dat_sal_w[season == "drier", max(x)] + (tr3dat_sal_w[season == "dry" & x > tr3dat_sal_w[season == "drier", max(x)], min(x)] - tr3dat_sal_w[season == "drier", max(x)])/2))

dates_sal <- eb01_sal2005_l_wcv[reading %in% round(transitions_sal), unique(SampleDate)]

rectymin <- floor(min(eb01_sal2005_l_wcv[!is.na(combtest), combtest])) - 0.5
rectymax <- ceiling(max(eb01_sal2005_l_wcv[!is.na(combtest), combtest])) + 0.5
viewymin <- floor(min(eb01_sal2005_l_wcv[!is.na(combtest), combtest]))
viewymax <- ceiling(max(eb01_sal2005_l_wcv[!is.na(combtest), combtest]))

sal_rolls3b <- ggplot(data = eb01_sal2005_l_wcv) +
  # geom_point(aes(x = reading, y = d1_roll_r, color = quantile), alpha = 0.1) +
  geom_line(data = eb01_sal2005_l_wcv[!is.na(combtest), ], aes(x = reading, y = combtest, color = quantile), lwd = 0.75) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.5), na.rm = TRUE), color = "raw50"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.05), na.rm = TRUE), color = "raw05"), lwd = 1.25) +
  geom_hline(aes(yintercept = quantile(eb01_sal2005_l_wcv$ResultValue_r, probs = c(0.95), na.rm = TRUE), color = "raw95"), lwd = 1.25) +
  # geom_smooth(aes(x = reading, y = d1_roll_r, color = quantile)) +
  geom_smooth(data = eb01_sal2005_l_wcv[!is.na(combtest), ], aes(x = reading, y = combtest, color = quantile), lwd = 0.75) +
  geom_vline(xintercept = transitions_sal) +
  {if(transitions_sal[4] == max(eb01_sal2005_l_wcv$reading)){
    list(geom_rect(aes(xmin = 1, xmax = transitions_sal[1], ymin = rectymin, ymax = rectymax), fill = "lightblue", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_sal[1], xmax = transitions_sal[2], ymin = rectymin, ymax = rectymax), fill = "palegreen", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_sal[2], xmax = transitions_sal[3], ymin = rectymin, ymax = rectymax), fill = "tomato", alpha = 0.008, color = "grey20"),
    geom_rect(aes(xmin = transitions_sal[3], xmax = transitions_sal[4], ymin = rectymin, ymax = rectymax), fill = "lightgoldenrod", alpha = 0.01, color = "grey20"))
  } else{
    list(geom_rect(aes(xmin = 1, xmax = transitions_sal[1], ymin = rectymin, ymax = rectymax), fill = "lightblue", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_sal[1], xmax = transitions_sal[2], ymin = rectymin, ymax = rectymax), fill = "palegreen", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_sal[2], xmax = transitions_sal[3], ymin = rectymin, ymax = rectymax), fill = "tomato", alpha = 0.008, color = "grey20"),
    geom_rect(aes(xmin = transitions_sal[3], xmax = transitions_sal[4], ymin = rectymin, ymax = rectymax), fill = "lightgoldenrod", alpha = 0.01, color = "grey20"),
    geom_rect(aes(xmin = transitions_sal[4], xmax = max(eb01_sal2005_l_wcv$reading), ymin = rectymin, ymax = rectymax), fill = "lightblue", alpha = 0.01, color = "grey20"))
  }} +
  theme_bw() +
  coord_cartesian(ylim = c(viewymin, viewymax)) +
  scale_color_manual(values = c("q50" = "black", "q95" = "red", "q05" = "blue", "raw50" = "grey50", "raw95" = "firebrick", "raw05" = "dodgerblue"),
                     labels = c("Loess 50%", "Loess 95%", "Loess 5%", "Scaled raw data 50%", "Scaled raw data 95%", "Scaled raw data 5%")) +
  labs(y = "Difference\n(scaled rolling quantile - scaled CV)") +
  theme(legend.title = element_blank())
sal_rolls3b

```

:::
